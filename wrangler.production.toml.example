name = "whatismyip"
main = "build/worker/shim.mjs"
compatibility_date = "2023-12-01"

[build]
command = "cargo install -q worker-build && worker-build --release"

[build.upload]
format = "modules"
dir = "build"
main = "./worker/shim.mjs"

[[build.upload.rules]]
type = "CompiledWasm"
globs = ["**/*.wasm"]

# Production KV namespace configuration
[[kv_namespaces]]
binding = "PROD_IP_STORE"
id = "your-actual-production-kv-namespace-id"
preview_id = "your-actual-preview-kv-namespace-id"

[env.production.vars]
CF_ZONE_ID = { env = "CF_ZONE_ID" }
CF_DOMAIN = { env = "CF_DOMAIN" }
KV_NAMESPACE = "PROD_IP_STORE" 
